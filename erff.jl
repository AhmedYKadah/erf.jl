
# Float32 erf(x) function 
#
# Julia implementation of https://github.com/ARM-software/optimized-routines/blob/master/math/erff.c
# 
# License: MIT








## NOTES :
# erfc approximation gives way better results, hopefully after shortening intervals the accuracy will go back up


const TwoOverSqrtPiMinusOne=0.12837917f0


#  Efficient implementation of erff
#  using either a pure polynomial approximation or
#  the exponential of a polynomial.
#  Worst-case error is 1.09ulps at 0x1.c111acp-1.  

function erff(x::Float32)

    ## FOR TESTING
# p=(0x1.06ea74p-3 ,-0x1.812308p-2 ,0x1.cdfacp-4 ,-0x1.b6bab8p-6 ,0x1.4fee0cp-8 ,-0x1.9b083p-11 ,0x1.6ec214p-14 ,-0x1.61d12p-18)
# PF=(0.1283771693706512451171875f0 ,-0.3761117458343505859375f0 ,0.1127911508083343505859375f0 ,-2.678104676306247711181640625f-2 ,5.127078853547573089599609375f-3 ,-7.836834411136806011199951171875f-4 ,8.705115760676562786102294921875f-5 ,-5.18120168635505251586437225341796875f-6)
#    r=evalpoly(x^2,PF)
#    return fma(r,x,x)
# return evalpoly(x,PF)
# return evalpoly(x,p)

#   Reinterpreting float binary as unsigned Int32
    ix::UInt32=reinterpret(UInt32,x)
    sign::Bool=x<0
    ia12=(ix>>20) & 0x7ff


#    Limit of both intervals is 0.875 for performance reasons but coefficients
#    computed on [0.0, 0.921875] and [0.921875, 4.0], which brought accuracy
#    from 0.94 to 1.1ulps.  

  if (x< 0.5)
    #DONE
      
  # if(x<0.5)
  #   # # range [0;0.5]
  #   # # erfc approximation
  #   # p=(1.00000000000000833989115771145318247767592446028302290090022269425144091613084365f0 ,-1.12837916710028395831628228876153637210226997076827239270923090555859887631189578f0 ,4.51710860538392991653674102577702729928015319997869761720342300723268751722667925f-10 ,0.37612637229602927226479389058351638359720252837960415612084232241386301913784166f0 ,3.1992790708509330143346422921200931883638370788855413036428747831813884389520958f-7 ,-0.112841517689650810481600896001263946614610914967686329879072604974738802646842105f0 ,2.560922338385300082651069947055911089316449602076336209835265178838741754398724f-5 ,2.6746936191055595085061659128967807864467287741370802971644440332060395440757773f-2 ,3.6673188138899716010458044486574317229454953935357975798048848182703065269335502f-4 ,-5.9546265446256047726931943011356068571571992949120547710089112896968828901791953f-3 ,8.8110422875669606814492321396638391736092471240905290085948760369857938226159323f-4 )
  #   # return 1f0-evalpoly(x,p)
    # # erf approximation
    p=(0.128379167084072442015971708878153077794812875442854468252262977759538466466026108f0 ,-0.37612638677173360887708232154133809982218085424044576090554860522057182310851056f0 ,0.112837843774249243616280397250157777250507394914770984188915122197580134574091983f0 ,-2.68652865375831097248410803484628824158061934615600565461807890879374835870381413f-2 ,5.2188560068141289500478726517878958032487316358404909126782459380536157982980317f-3 ,-8.3948481565340715162646401327604259604058983841328238470236141987304564416187075f-4 )
    return fma(evalpoly(x^2,p),x,x)

  #   # # range [1f-5;0.5]
  #   # # erfc approximation
  #   p=(0.99998871620833775896816781314662267846605356917871640162008828883067835455568024f0 ,-1.12837916698744503945598687609367453099695176928166995195571465446640739473811852f0 ,1.1284243295134601436023244275536740829054602930548711076491014988394692614423082f-5 ,0.37612637218601479746589401080626171698097849307201679976281397086836881133949201f0 ,-5.3220152511807387195801127068139745476947721948597839229614151789088496867514164f-6 ,-0.112841517175995226538514666320623887213585047526043866007435800128436102045197688f0 ,2.7487146466805049418828411098964719331247198213185665291378133948988329481715356f-5 ,2.6746946206360531968553330502440450298147987498298994599927321532359576389405708f-2 ,3.6623906815132189962246234309655759522331090516301036503997522806720350423042426f-4 ,-5.9545988652256436899448495497794566797333334250764613273906492043495761131384775f-3 ,8.811892698770857741884336607349584024366548824690222835086051515680369235338807f-4 )
  #   return 1f0-evalpoly(x-1f-5,p)



  elseif(x<1.25)
    #DONE
    # pick: [0.5;1.25] at 11 degrees

  # elseif(x<1.25)

    # # range [0;1.25]
    # # erfc approximation
    # p=(1.0000000000006966793536848224175282476317335951524245979707835799581429612519846f0 ,-1.12837916714884350872997332876296967883877998199921632848638711927742018913733394f0 ,-1.5115780113769031140440505290011752511948457809166685036443899349562760226801995f-9 ,0.37612648824913557417173420642153645462783635632939787082433354565211682823508316f0 ,-1.73994038234460709367901867771600753488464097961544685643692703090402004352912602f-6 ,-0.112822285308151839103084835551120504786956001142324654258377964015744122386082284f0 ,-8.538059136295859302841954266171405228024812988981216111991085780909811866313481f-5 ,2.71733488073340492099215509779811250325850488496089573127276843423637990167525525f-2 ,-7.5944898572425073404064799322738825047737258455277382424048244388614144481023951f-4 ,-3.9078293150144550626575781933537121092887533453514551952114134083706664610341827f-3 ,-1.6005998872366740503860065756853341993048001996732482570229188569112950495509824f-3 ,2.19141197081650672370635237900198985448533300948421267924143406727112697094070044f-3 ,-7.1861989498978391762199784417340040222574295487687486546222406756045004492282495f-4 ,8.3030605864932333797068019906303596042706452564054690361283080694653221843626034f-5)
    # return 1f0-evalpoly(x,p)


    # range [0.1;1.25]
    # erfc approximation
    ## 11 degrees
    # p=(0.88753708396322851929469730735444908553976086257329012212173937667670634867635525f0 ,-1.11715160665144315914719946468483683163954776527881237519242464872789365407126497f0 ,0.111715235050100348745824649186846790747824006576719219216464662383469929606236606f0 ,0.36493394995950552858458243468005161235339071979119231360390758209318917831893194f0 ,-5.5457820131751959214325691078984112751509470000278776679481641648914199892451786f-2 ,-0.107443844423223540682657156589029336122167769254579212432384873474766044300437502f0 ,1.911795387127524376257195149397167924631964952380640873564950363562699895901987f-2 ,2.3023798053768842969908272189291986173098033895442007750036363362473696968198096f-2 ,-1.0207421731097611930268932490222691922666800893907396933505932575291783401055367f-3 ,-8.9598911867368855851271409578283095138899205137372456022482094828433421235204581f-3 ,4.0881152269171723790575044654747013073327537741429880733086795682258131074429374f-3 ,-5.8730111414685106526351441479570431336042676177693233815316714559821272908147528f-4)
    ## 9 degrees
    # p=(0.8875370805907334281550531322458387024855275959338187884900900875460705512610472f0 ,-1.1171509516455304409234785779744858827080058500876582439040020414939568421751794f0 ,0.11169425071923245705412754448476622102090535157722381619798006008967071680209158f0 ,0.36519601341604920530667018155391961150350362963925172235193440671497779599209049f0 ,-5.7135243870105186065041267457618754985214030482499366702421828939702088908748082f-2 ,-0.10118561249153108699536241349189168889865562237000583303024092599916003807813734f0 ,4.5785641568542927798905406212274349785384289599185736388541791299921921874411427f-3 ,4.4685582235527708928665411296986219670769153927771204494687243678768157900724718f-2 ,-2.17161580487794876782044803516078957178288628549221581411514387757556825260066627f-2 ,3.2914022610085331727079975891554754609349792736267661986095996457693674518543747f-3)
    ## 7 degrees
    # p=(0.8875375382653391540305521373020716203447046457946797404977783679847248083322303f0 ,-1.11720593362744828375951608498030229073218256156377035011898342502836877718996443f0 ,0.112782361461447838304970986044254244897720984854301052512183799583895394391436167f0 ,0.35691951552348947310542337119169882998098176432259402278472200883777553303126567f0 ,-2.5727581042116660300436962195123393750748715732393952107723120314922803080622995f-2 ,-0.16769388790054868097234877134262396825181055188836433991751601747992107248479357f0 ,8.6505790616882923394020802239604439250166456438540525977579134192528763096147047f-2 ,-1.3322521962342035985943325668192474554855217771729555647837609032232015640587476f-2)
    # return 1f0-evalpoly(x-0.1f0,p)

    # # range [0.125;1.25]
    # ## 9 degrees
    # p=(0.85968379291636478426789395055490066402698732995473548579737968163703596570679988f0 ,-1.11088481270080997687220305581559038005216484550123175394409003284888875091648296f0 ,0.13884554708698698890184949921777477501434474906642085267145183649017041124524519f0 ,0.35891801455778333769925493380177362648045183941339863125856034799569500561791002f0 ,-6.9989215516326220354640406013800005452816004493898801329583124843170141614176846f-2 ,-9.9280406098304159329027560786514477571015731823923764291314897061680181514721407f-2 ,1.10939229914794492638428216358601435773520299208756170697772486569089827029970928f-2 ,4.1198427561461649268086552935129597934008061645243517407056687180607632038418284f-2 ,-2.1333637927753208231344418785825687381446884381536444697084543744635682355669084f-2 ,3.3601332458007038239423699552389993962286503163780901335533873784199016674490909f-3)

    # return 1f0-evalpoly(x-0.125f0,p)

    # range [0.2;1.25]
    ## 9 degrees
    # p=(0.77729741022855116232615676861229102855879778975081267056478252165357577071867578f0 ,-1.0841346593305872921127827027988137074236869840772028568755058202144016938519353f0 ,0.21682214811144635605069823539668386836805231656087563091542218822680871028850298f0 ,0.33253854139401514503029172435608555762005084140775632849365688390360067813788905f0 ,-0.106052169091999432898452386001644294888970808008360894965774822062718860545642013f0 ,-8.8985418133671147504524801200478125775173053913702736907013431976419570547383525f-2 ,2.7967465154183079991760202611522393521429951487516305008152651307122368046233692f-2 ,3.05167627042363286507985239228910231796837907694098502453146614318716047327537295f-2 ,-1.98005429092058006257123304784310028852035000058828910374958263343729866979586537f-2 ,3.51648405870366635087926437407303417824149294726873507666144540557342798012405676f-3)
    ## 13 degrees
    # p=(0.77729741078976321962295738819603637216552304845988889347813628847936215916815207f0 ,-1.08413478719095251850804476481634320383491454728576024004594873657119131843793436f0 ,0.21682696249983266710111243356035033981833275605869410187158663452802152826384784f0 ,0.332467883819259028887937631400209230644307577658130599079928159039012180154449355f0 ,-0.105521042651846139136040784473920144146322316873199150698574828624542900195398103f0 ,-9.1308618268095790835133511325612503703981854229862607156546412725443282805776733f-2 ,3.4271132459094501619228444580001654415945880178270121490998088169780340167192361f-2 ,1.9647437479802415156140762400105854439511538646928069114303446245618784793103545f-2 ,-8.0590535814778223718167635965994822154768982261596779888023794078476599661497503f-3 ,-3.8029812560161191983953422526024094344442825446093955949180899131152568507988677f-3 ,1.82340500483635679458333020973681546419002958258756343824124614396728278440848543f-3 ,5.469931893782177284033487345082276364748396399571133089544656155077829839786405f-4 ,-4.4292018702511630722497772187654553415112705480932376671042071707661641390124771f-4 ,7.4199664053137064454873709085055552479288506075480028768367851752949585726400646f-5)

    # return 1f0-evalpoly(x-0.2f0,p)

    # range [0.25;1.25]
    ## 7 degrees
    # p=(0.7236736918718207157201727839761339441634518370294399730934160101180274608803944f0 ,-1.06002595195373189191652184146326379256225118575853254340716311304582257910197045f0 ,0.26528372429346598493522128394774079714533592251489327182385298755636990608714842f0 ,0.30662181312361569998306133111934321566163386513939004781615014625896324600654445f0 ,-0.11543640314879204531539121469837950682295543438308257281247880794391715931441792f0 ,-0.109060261817099446374396329088368800395647983682761647815533985176301044206853382f0 ,8.2176372018137659063692826624112119468646825113108031537712938140483063683324416f-2 ,-1.61330306038172575271212698736494608530094697529316628537367221193104057876744123f-2)
    ## 11 degrees
    # p=(0.72367360982085127754868935376862168982886819588446820557506676888762232326745843f0 ,-1.06001412650149824732487375314002175283259393744886848632354523544526553646007662f0 ,0.26500340747301616984416933026101231374570191737624436265498342506265251482362507f0 ,0.309172886738185901432831907985809914467903753567921959187389316597177396582259255f0 ,-0.126998664756027544956591538427098976396757456431744758974839527320168462449780016f0 ,-7.9967820908969496835263343572567477507752526120300769974362900682771377108697383f-2 ,4.029496316545442702859219902349104247222656895085756214490767352014061765887946f-2 ,1.6516057142473870199726327070004818118325110585234249943685304984284030066708796f-2 ,-9.79285881285058136252245172310108332137714965731111238923457388403847635426981f-3 ,-3.1990278884190329464002114046959361921860626599139495238340927169227940516931571f-3 ,2.9726771783210730265550477905267540783250122459281853753280181887920774861376253f-3 ,-5.6123091790783525767872729582504499006269121796431783167396463341496282699206454f-4)
    ## 13 degrees
    # p=(0.723673609831906325145539841908829909810345259666551549623143592696205047835155f0 ,-1.06001412943046507920717267169918486577053417088612720912358803495115387729189182f0 ,0.26500353576042509677564250694645766107881442817171422548258256863912230814673179f0 ,0.30917070336937266217754005775202043845733989540827845503847829526083320947927346f0 ,-0.1269797771881395419892747082595436688232878778296843768566059669426145906053501f0 ,-8.0061401728687873809327925116042843045351623793500932273767254803956914698732564f-2 ,4.0572946231328473223979751265294908932569195866264390713698321040261265056714348f-2 ,1.60340414734751379342989043863195330096306781652820810471643162595148302013249965f-2 ,-9.4080829325342667110822013210693404835923556155111989899446843439073056772465747f-3 ,-3.0244404904170515513243938953412028222589276671932612811338109918731479769661296f-3 ,2.2312505399101954309232000660454592962927614093560749517638052734738875199760373f-3 ,1.92183469931457266084198725244706340411221785302749502188626928420633694771902004f-4 ,-3.5945252220086909548732629774131062715901342514464950341909705665488811409475413f-4 ,6.8885359780362403745394015075096098878327601046575581386359358999617631590512429f-5)

    # return 1f0-evalpoly(x-0.25f0,p)

    # range [0.5;1.25]
    ## 7 degrees
    # p=(0.47950011687563943919771403549797104340656832227173941600841603404679235714268664f0 ,-0.87878190418196526400088229577702366251613756474794089777138513401150293839462967f0 ,0.43937797658034726895144655146492714865785472508058729511141756923390993825628051f0 ,0.146542377771962272903636223718608637320313135995848197212829288862987333329413967f0 ,-0.18308122209457795016009442802978541596730530440825028723765854987287083422518868f0 ,-8.9567342459553193876683699676888087786472729050663591646835193540031084384623707f-3 ,5.6763437910972800992263320058224481444904251735642906640916700700952588832296886f-2 ,-1.74976492286154450711287556721687275080969383429338888594938185227710732284903f-2)
    ## 9 degrees
    # p=(0.47950012227567176160968855565657019398253852011631450719824180142732684373712702f0 ,-0.87878260156933375086543836591955768219493967114186343734348570068336805049076484f0 ,0.43939224020209604188497098843847913138641942918353982675677544051781187271042761f0 ,0.14644837921389095106232030853613625798855436953327294008266254944149672089152521f0 ,-0.18295500486283452992059084081935736385392413171485496339361739478030373048201456f0 ,-7.8890831740885267455571733757577259837758538159980620040438136123193866192889202f-3 ,5.1526843070921108707095279365704289398523919268115857120330616796712346947894848f-2 ,-7.5364527078152658848639431113124962844294210052127458936323524653635048203699933f-3 ,-8.902438315364736214904959920254595213071108025363936844763243733083501925898713f-3 ,3.0958652269983420324553599789941590081841682511705312233318135647221368298146732f-3)
    ## 11 degrees
    
    
    
    p=(0.47950012218627633266759004480928346323282597139306026470914603497045110845486174f0 ,-0.87878257867905935820797978014037919344903083907274027447236660730320123742574287f0 ,0.43939127340837007019212165648359529028950189241566682841945406944095273511955846f0 ,0.14646415648788187125149469711213532491861248937046075996222718522704324115126361f0 ,-0.18308466657525286729680773848609379638263457954975049708494183866284386220432776f0 ,-7.2864220919698610613876940798326935208926368515022370715399462640511442447273458f-3 ,4.9870470155967931820488830916894059744198728056328087545059900897748278238141407f-2 ,-4.8868244174386309272067176761136942655656143898910274020685204636212063119576779f-3 ,-1.1067663329874328692394302924580932358903686528252386541750628802256971128485086f-2 ,3.422346846104011114882331840937679141622349918363223030054135870224315763897819f-3 ,7.3027064271433070734900533407935697302293380332736344236451943042328241926267078f-4 ,-3.75817085020390291674591289563810393435170791862443379088867595819930602228183736f-4)
    
    
    
    ## 13 degrees
    # p=(0.47950012218695707528023526222222714141918241081066531754838014965156512400812443f0 ,-0.87878257893732714099697040320474001079480023634665367235837732766806846730422566f0 ,0.439391289630317595558659049530481160637933056514221943666143375041806605414600795f0 ,0.146463757626603945873222552183214282962692473197506120392602742379210584856010366f0 ,-0.183079605906956165500907553488603496054770393390240374644644933763216905956850885f0 ,-7.3242280521778585509392806422041573392058165886547054708280370809257857973077298f-3 ,5.0048917271706669814471645185148881216227519582418200553964697556408582180535156f-2 ,-5.4383035660700635665576791083911272321228803062208209574394431764939558714231225f-3 ,-9.9411071320427790176050541632098548475441848144914557187022613400772837376475712f-3 ,1.92812167893222886250747616163993802011019825550829041862685914080224537884360525f-3 ,1.9408171310408339329342598554099649393123535937133972565507927444598390980987512f-3 ,-8.7966954346211829778305100670774708131782462237489104000921709880347866087188071f-4 ,3.8471253622372946582300774385031408590712509491533133120857014424901957102752914f-5 ,2.885829102139462318790380514012532380387471813480811107182055068531741243689331f-5)

    return 1f0-evalpoly(x-0.5f0,p)

    # range [0.8;1.25]
    ## 9 degrees
    # p=(0.25789903529312712714021347420894300570051666818669733811086994713382895641541128f0 ,-0.59498578660655266495892613166864113911324454283076714657333080080037195635913695f0 ,0.475988654529987732424288966863060050998538402956357346628824993799363588819193696f0 ,-5.5532730160707484738765757576358527853102670144424690562861173937798307657478779f-2 ,-0.13643967319557042271107640285233594800637790008362997448221742467568444388400915f0 ,6.0237933410037573833464882753332561952652316619650605553421628083127257129426744f-2 ,2.0728423462123225025387271176057730843867443663412647877594043524554786169257831f-2 ,-2.03146563610403167233874381853113561628254252559858790426680481117547367041112037f-2 ,1.8282408112239785532660834987730441093679608977453639999083340665054621662293458f-3 ,1.57194634530114564812393582393467043537842182855043730788215445433459904857326476f-3)

    # return 1f0-evalpoly(x-0.8f0,p)

    # range [0.8;1.25]
    ## 9 degrees
    # p=(0.25789903529312712714021347420894300570051666818669733811086994713382895641541128f0 ,-0.59498578660655266495892613166864113911324454283076714657333080080037195635913695f0 ,0.475988654529987732424288966863060050998538402956357346628824993799363588819193696f0 ,-5.5532730160707484738765757576358527853102670144424690562861173937798307657478779f-2 ,-0.13643967319557042271107640285233594800637790008362997448221742467568444388400915f0 ,6.0237933410037573833464882753332561952652316619650605553421628083127257129426744f-2 ,2.0728423462123225025387271176057730843867443663412647877594043524554786169257831f-2 ,-2.03146563610403167233874381853113561628254252559858790426680481117547367041112037f-2 ,1.8282408112239785532660834987730441093679608977453639999083340665054621662293458f-3 ,1.57194634530114564812393582393467043537842182855043730788215445433459904857326476f-3)

    # return 1f0-evalpoly(x-0.8f0,p)

    # # max ulps measured 1.446231722831726 at x = 1.247298

    # PF=(0.1283771693706512451171875f0 ,-0.3761117458343505859375f0 ,0.1127911508083343505859375f0 ,-2.678104676306247711181640625f-2 ,5.127078853547573089599609375f-3 ,-7.836834411136806011199951171875f-4 ,8.705115760676562786102294921875f-5 ,-5.18120168635505251586437225341796875f-6)
    # r=evalpoly(x^2,PF)
    # return fma(r,x,x)

  # elseif(x<1.8)
    # range [1.25;1.8]
      ## 10 degrees
      # p=(0.12837913454896447023110550374085999965554717802353243937076282449353317694277005f0 ,-0.37612614757706178912949924942956974274956136138015772217943496974022380196135186f0 ,0.112837101878786565677795749928210472264261207126357186211184514605409250563339296f0 ,-2.68645181731595088940752591283458610182513153713581328167062081639161399949892833f-2 ,5.2217371639769020424777931622506457026927747116833115644408865714806105486052026f-3 ,-8.5269608845189432920113473706726031884734396171081378002669627183196333982009444f-4 ,1.19086066294807428056763359198133013958420917043868844903368914932348249832378979f-4 ,-1.41957667706413934315332285121181749804907657399960857313183911340950209498789907f-5 ,1.38545409106144368108957677483314981806776455404648900031342205523040984578711923f-6 ,-9.827112488690792873076074028282406517147195288951756710413031882111938681485383f-8 ,3.71405684302916436924446143897860267877088902470532158920143234333978738948232456f-9)
      ## 12 degrees
      # p=(1.128379166702887867892198888338239939584228436758526765102339521055518908971914995f0 ,-0.37612638560026469401160102043544400005609870502811390059871661632834468516212489f0 ,0.1128379028659991679978424065914951538102979218842184306862704142591840410838806f0 ,-2.68661364997845448807048883613021950305421013253212329741058605524263569072734175f-2 ,5.2239201416334136331232510163068722898116735098772242151675713707399399161332392f-3 ,-8.5476289198574666058490582627643611387826504192266058252178286522210073313185992f-4 ,1.20490329733113594509186091730272940936219045738275873990259186504173392634029353f-4 ,-1.48827879063407124726533238094187985927576951582973748642792958990433723300239705f-5 ,1.62415252916410825402272512745014186531713620579070959895658294674455173217871576f-6 ,-1.5512595760296941982571828312620241444361859742583068221244871666039927393839866f-7 ,1.23674731443731931975257051859996081851242206410608133246066711041459773795529995f-8 ,-7.277650972089403632838977719992314136939981373845961775160652077878810720088418f-10 ,2.3122881800009137078835316235839316773611339224097356412961219823580608118470107f-11)
      ## 13 degrees
      # p=(0.128379167056572036989475743004111024265380352859289904347092405865239205128882337f0 ,-0.37612638866572218446770215440917494665540790054888239506278164754202606498943644f0 ,0.112837915111577583464493599125247744571066894996563451109409619116423917717253982f0 ,-2.68661663522455885683468869563097750577292431427929614289284102366614662649962336f-2 ,5.2239696919753693833275747126527408609654219173636869145417475751237211889807116f-3 ,-8.5482202682868315516039106824981633480440656264606208055068554785789180925685152f-4 ,1.2054253389837421230327017166105257539185805380867076460666713036355534524620248f-4 ,-1.49173045009682243351852564423450624379968937922771590640542402627696110060386688f-5 ,1.6412453270498713354328646846302608076511271961679191865868925203945358085396087f-6 ,-1.6138729833414638805650396399921657938104033979737960712789530053201896694923249f-7 ,1.4016616960178818654534409767384478456195339752278440795678149878788727158047915f-8 ,-1.02351513370774034334557970374084929627803778868362834340682519416353013499366615f-9 ,5.5491187138978862865970181351708470412387011214696745162972890558105373811165471f-11 ,-1.632804188044130195366618548681855252548710354123058480674683735586706108604108f-12)
    # return fma(evalpoly(x^2,p),x,x)

    # erfc approxiamtion with 1.25 shift
    # p=(7.709987174354174681568448196252959406798131782870238657920292148927498832996533f-2 ,-0.236521122447274328470375668688422686477432663345953809971523565192668696736789953 ,0.29565140305716459037982270908420363767094601965098592625749123603900955872789565 ,-0.167535794975945479227271229750778819444148097032916301984120580081671068554165554 ,6.1594020190852943712326915664323560617014410594256610650273051784906076062412052f-3 ,4.7181068625423578818504334276840386039736554110530019529427379990679373731972107f-2 ,-2.1301576990200705139225304284693594325696022202767945165107732004780097274367173f-2 ,-3.6240366845608427566244287734314908133993029189787607488268169502535393737512785f-3 ,5.6890080867849876258518509672656250650643264696096226081801315218330518981797841f-3 ,-8.5047967433416081539540911651876507441992499227798863208019788222744518616019791f-4 ,-8.5295327698196641701959042612784106427214513510223138689315266690784168322536972f-4 ,4.1246131117692996176913858461313896155911849131166755175381597114224949112017953f-4 ,-3.1201678651622144527261414439581288416938867647431729209377173356675592771214171f-5 ,-1.34112875522839297153015234834580153324392633281295072288996933509917119556863478f-5)
    # return 1f0-evalpoly(x-1.25,p)

  # elseif(x<2.0)
    # range [1.25;2]
      ## 12 degrees
      # p=(0.128379166327788033416737288600941961877876241683948770956172401719351596106f0 ,-0.37612638266243322608935500260528326917692846358634523874290165468872395360843f0 ,0.112837892338385657450077748207372252288036422153796895370612964843101668810444f0 ,-2.68661136755823644397685628246171438182014696631662160818172007938298822787976f-2 ,5.22388679767399013226959915622304885344663715781507555122548359166303946651275f-3 ,-8.5472831123238198294122078458616296854463050876327529543294058090958136804827f-4 ,1.20464223543115062923340474900666089193466015557059186781000049011698119964712f-4 ,-1.48683324715167088339334573420101943643106479461831051537972493927408856899409f-5 ,1.61832578970775179305538524712634121363154426340141168150614354414327557669746f-6 ,-1.53458534826244360246926927830388259856789101586794805879878589351169405619392f-7 ,1.20459097631253564986819054745321435441928947020282110562660415723426562787379f-8 ,-6.9024105504356963792435539193300365201254047511405529680734576532460673949023f-10 , 2.11191030392635875132961357493811492044927043210187756376599953560782743876486f-11)
      ## 13 degrees
      # p=(0.128379167014889072733989093099602897684087320143111798735253164305086341256126f0 ,-0.376126388312353819987767031096074298183585949855179639486841835568433572857667f0 ,0.112837913731153262671941863485452682882201509762730718133747886152272376403363f0 ,-2.68661630619843400121520756451987767484437842983098250598915594298612650599337f-2 ,5.2239643532869593699934763272531041859696696061012351515116270270591850541075f-3 ,-8.5481579960130158235661695742021413718694438376184140213388079872956254901305f-4 ,1.20537161717319930439471728789285075356149539944637874992757473149164086952312f-4 ,-1.49138339065707821295395806091580732752749271345769802917921992156487734634297f-5 ,1.63956628604938724115593436874754831031791342280301965531973852544698896470992f-6 ,-1.6078649098408681855528205378836239655555293272706971385953511152086070761027f-7 ,1.38620560692987809991601962817337003200721427630314912829533925880880639897549f-8 ,-9.9644449295728905004057330498189139535939306214784173737128582240710628726228f-10 ,5.25978971926061310518061110776657090729140460613492832124781696758954035847906f-11 ,-1.49028404642429433186383681630555282824846201120870319247649918166562752355613f-12)
      ## 14 degrees
      # p=(0.12837916708755791220607867977296255652171162946078811442953186192088750190005f0 ,-0.37612638895585364734211693714920984928212018831391473440414452618048983098652943f0 ,0.112837916371167911695965049347175642392402716788959461465544735730035446340257292f0 ,-2.6866169712934957217092257234690924011917233517952262456855848293726670656162317f-2 ,5.223975848251632359058358399775745223703707651806483986394422366233239968189122f-3 ,-8.548302175728329516848123097618857023826163281217969511180284441328310329708507f-4 ,1.2055069612387005202518579780843217306388990484209783520235065900466816282007586f-4 ,-1.49234934071983999890178362078624669578917131005043101038462080936753851091016878f-5 ,1.6448333534246538755895558116628987323888226292286133680088719855625624294296183f-6 ,-1.6297007435488027218915331557478027826041096704809733649337955702650494571589615f-7 ,1.4539575563379228066941408417282951855175078846237046768274754165566034523232184f-8 ,-1.1490131176003810050039000840441773938485158799248468348972913454407111820711651f-9 ,7.6169014703621232513966758470454338243164473547190989870333011728895718446934144f-11 ,-3.7266642729820212830692735013022006559342262045247106622783174469284679198656047f-12 ,9.831183591219844233708069609934091953037012783866741590773227273289018797442832f-14)
      ## 15 degrees
      # p=(0.128379167094772585763226635152243109200231080904604786525883952211079923549032803f0 ,-0.37612638902430389589737519087322321946368105664052068841589719983164103166054587f0 ,0.112837916673635498108766470546551154131759607502233380783194071921335024251759404f0 ,-2.68661705386796252357404065589376568963285054320946581106265890599200615062852354f-2 ,5.2239774058365050294598207031695251526416925805550702646512263432125254886713765f-3 ,-8.548323678780701301008574353468696780081673103370751001203480885325114062794861f-4 ,1.2055294061122596795100766387251975686814339038105818682891071685996169849966673f-4 ,-1.49252971494385007203320462564739762385544062511537600810575250220840313168615576f-5 ,1.6459585650051291147859626759771258090631908237777021220159339714597335657312906f-6 ,-1.63514952037124647675256902158030840697608618103235416777106916275942122943578518f-7 ,1.47427234051932600270469398949394024602453153512030610754696434856889276322923446f-8 ,-1.2062805276805805014655272150616102698831512897372926436190618261592450984286751f-9 ,8.798484190517414193594586990342752518930477220607290899635453396569345220570446f-11 ,-5.4112138843945885104341762015524616658788308345806752933242934930318407243768552f-12 ,2.46698845686225177179366643642609382347660129842020998520250732938329396756246025f-13 ,-6.0881845568594514159084668364624231870501668014421075031040522927102842393729402f-15)
    # return fma(evalpoly(x^2,p),x,x)

    # erfc approximation
    # p=(7.7099871743540408192352198779801629558745753728447724764788520425842875471994456f-2 ,-0.23652112244657097408174704096259282049273371192620215128076235477774020544647528 ,0.29565140299601186061148383003401166685690757452085599496554823713478332573052066 ,-0.167535792887475807704660115350935262818119328166597391995454050644162167447363837 ,6.1593649361223010766289223433850608995535775974261017455906347671335996269552962f-3 ,4.7181461079329213785400642701899627457249726880416331178209232825079696517868636f-2 ,-2.13042490378234137309877656146362058042963353877231622022837020724446430429979714f-2 ,-3.61180991596351358683790669858312642863080656463492569859630947453580600363995446f-3 ,5.6505774938469122278019168332360095080161363424047516165633838850159519623385231f-3 ,-7.6720645787285433388217150861615029546656261881112530279535642788847918691524864f-4 ,-9.7534561739071691664834960800420721428417031927960350390522187812571008719954392f-4 ,5.2911292089399542857748611814338062250986707117816999897259760609902637434812595f-4 ,-9.6312870593076650467761262968922178411675588945383135747260360058208829929603063f-5 ,2.7618533457771305074701727170356235644300386809925433797514902284747189443572406f-6)
    # return 1f0-evalpoly(x-1.25,p)

  elseif(x<2.5)
    ## DONE
    # erfc approximation
    # range [1.25;2.5]
    p=(7.7099871743416328126356260566547494286908999516428835479787235777958146662395595f-2 ,-0.236521122401763914017434484798130978411662107330375092318490618856395191655478216f0,0.29565140031735793699573224918347147906505950384598003349376150036910634397925794f0 ,-0.1675357298956664512006671881841788827839151996664942041368823179421003600967294f0 ,6.1585929514334837247453472606059635765901344910897544510201614098797139034234648f-3 ,4.7187118101037459805673209483303989110029907488612006887134009408435903419517292f-2 ,-2.13310233800625824496628789189780598311678632855392393834221656949343403265787497f-2 ,-3.5262544206616132931628291419365561301271536625777609043061691511329815920675659f-3 ,5.4618311186313877025711961981462734764321122794521259327727086934478142942850845f-3 ,-4.785867288141399400801105017099155449896231371492841611827465311139149075249888f-4 ,-1.27638529129849191843323454760991411930129610353375308047589690520960413915824394f-3 ,7.3386942792237055752542546076918383420248583637581325208367761430501498054660812f-4 ,-1.78316578653402766600700240536421560298308014794597944402973993319799701405750455f-4 ,1.7451623823305231302742688272669315889569143556707803172195238203096188492888552f-5)
    return 1f0-evalpoly(x-1.25f0,p)

  # elseif(x<3.0)
  #   # erfc approximation
  #   p=(7.7099871804178084233458479688330247380602455059219177701381265632520963737168572f-2 ,-0.2365211357470977494117502367349927138037204281205889847044615618196360725495571f0 ,0.29565188629612698160035296672667834469328532649796211138666262963098659992995826f0 ,-0.167542689114393636838253019597497119084632015988325302616190532444358624004955274f0 ,6.2104316972102297867475015662402012523619708108393015793823133126920470704624435f-3 ,4.6956953434526529855651766161038126651216389993788200509887418722482742152310729f-2 ,-2.0673753600895375186517021307505003470594754737816291155844994878265475656974124f-2 ,-4.7870291277018550796654168034867275196402063620470592487702154528525769895583851f-3 ,7.1219399717056713205270325432782886505894779287613598000310029303341461130160156f-3 ,-1.9843813771212292482485823023760602768720174553374264466435250579309543550123946f-3 ,-3.5068615385931655639180191285989787964176814549650846854398636214473773418246979f-4 ,3.65122465644345504644212840370685367262023850587342596082441454541748400512140874f-4 ,-9.2352129858462625974576408020688977101599210456091241998417023025201076064211691f-5 ,8.5381930210562873258712319829024720433175857069058572697480161070768212389696766f-6)
  #   return 1f0-evalpoly(x-1.25f0,p)

  # elseif(x<3.5)
  #   # erfc approximation
  #   p=(7.7099872865348656316127600877814424563784604695275033403715269097301119491831228f-2 ,-0.236521324039564760116363302069359060332233113888080927235444939664536600573041566 ,0.29565740906875511410885222589281449566839716614459595051315319490254711519437274 ,-0.167606230731399837199269914480797516855923544879984300448234824429220980074189855 ,6.589910722503510705836812475059734513939136671550927413726998354545328830913066f-3 ,4.5608665217071518690167781936168444098417627206358166812917415799938027535839893f-2 ,-1.7598185442152008259779643669791279294367529790231744480649230095683309772390984f-2 ,-9.4913555684924619713338663163144776335319533818427926972004011071002185298867258f-3 ,1.20525202727455316163449367909866604216469107953202552178615601807202327754435592f-2 ,-5.5374910111162918391170865742062912083137271916564150340079410131304933186528666f-3 ,1.3811611866098571556852235572562911396298412018595626413072586196623241016267715f-3 ,-1.80635406945780779469478186704586012014501904457265117228058066910864933095807914f-4 ,8.055175947599651201155028898616242984613339685997016373656834002848851561127344f-6 ,3.4390558383009709165274927755943481538005139869458681395462602785849884329554818f-7)
  #   return 1f0-evalpoly(x-1.25,p)

  # elseif(x<4.0)
  #   # erfc approximation
  #   p=(7.7099875487300780833537662547903465881272144419188988868256248656470816721956143f-2 ,-0.23652172636403503434554491886427629442280135427402503724673171722111001698236327 ,0.29566756260305602441141207104646391088734765077223108558955245158449656690660428 ,-0.167706272112290768488255478969838888357468377913636469510976209677784633606786427 ,7.0992677090045131517062822350053076591385141421754810903184596782972804115350488f-3 ,4.4072394436952101147405219241747894921227111674695378525018086871385028408197941f-2 ,-1.46356279098792557489513983426347032654485316892283648382106493872901870856638476f-2 ,-1.33068958434966335905545191794387044490288503842723946290009434032034011715704652f-2 ,1.54066470476077524531416063622241173323023434518692005147234367159543037870476621f-2 ,-7.5570514183924081019407080757028728696259465173427308309311553033338884187705977f-3 ,2.2005746266515155030745994543677519819403312359704792117121708860551089337817706f-3 ,-3.9480130051300091490275970928048020869204400400987452084525583024280325883705708f-4 ,4.061768625432989166836347068434885854127550818691104234159866044362285992896068f-5 ,-1.84459954185272447131991821176269800820469459742655819697212848443396107305593406f-6)
  #   return 1f0-evalpoly(x-1.25,p)

  elseif (ia12 < 0x408)
    ## DONE
    #  |x| < 4.0 
    # range [2.5;4.0]
    p=(4.0695201730499156824979069048504659592517281936379802348048709133497117253173134f-4 ,-2.17828418992563158453260234674605666557610132217183615223667886784864793391972216f-3 ,5.4457086379161451966966115384340866958878328106709954104596733367011474611248579f-3 ,-8.3500528577413591092464067696190605106058226371648352228707616455735161644530442f-3 ,8.6220108431254600006776817786647116978577973677436276371791579294890933467761521f-3 ,-6.1151670580428489239821330412642128179703517796977571695036324539244245861906337f-3 ,2.7899458310817905157828387844634029030573127219171061924068857965376725014125688f-3 ,-5.1939500417227631511066424033635849427151215499427143347485235667556121428433924f-4 ,-3.0461048275173680879818513198875622675191891190039217228437020935156706025853604f-4 ,3.1068457426894474803882479013975662189036326925351567029013595934579911165234626f-4 ,-1.38668990773606991790025193904557899401436779771288081224199889420050208965460715f-4 ,3.6909690646602578301139502069782980693656088359691610474313757700491321631191208f-5 ,-5.6828887569336940854242289035551153938157998442490411471025066283558049904037765f-6 ,3.9297630357752347428080345871297027499036518175420666529979940028638158683656671f-7)
    return 1f0-evalpoly(x-2.5f0,p)
    
    # range [3.0;4.0]
    # erfc approximation
    # p=(2.2090496999208823000416149805174562330513175898103008548990217790625318292807856f-5 ,-1.3925305219033966802283343368880730322886938781625006879011395805211127930520146f-4 ,4.1775917162002035218707618997057816521034553725829223415186053333240532739870073f-4 ,-7.8910103000756111748279665400605287506777779322790856965013368869168063720744396f-4 ,1.04440323433691738330783041157042034193375234900949894556694026773336989552833926f-3 ,-1.0165897140179434344617636012100890328595904780981065571616406325828669681073834f-3 ,7.3825862097479270505158876226926711225266274823088242090966093254689575657839301f-4 ,-3.9132322833954942769084970321901592606518625839224992378854012605602206428472318f-4 ,1.36567517109263554282893957520911360594948225879481219259420192208811430668481966f-4 ,-1.6849094429734963557201836635827334414256140067702601189297498876967617733002536f-5 ,-1.23747349923821784059979015124072509740887755762983568751428814323281566417220315f-5 ,8.625407851126933197657594854914770918643979664003820837032489484967444674002432f-6 ,-2.5032082134122547405965500437400555222961485828021395870836494128252934119220099f-6 ,3.050305581169549810687942210145314225771995734991102464260818501085192501601652f-7)
    # return 1f0-evalpoly(x-3f0,p)
    
    #    Explicit copysign (calling copysignf increases latency).  
      if (sign)
    return evalpoly(x-3f0,p)-1f0
      else
    return 1f0-evalpoly(x-3f0,p)
      end
  else
    #  |x| >= 4.0.  
        #    Explicit copysign (calling copysignf increases latency).  
        if (sign)
        r = -1.0f0
        else
        r = 1.0f0
        end 
    end
  return r



end


# x::Float32=1.2

# print(erff(x))












